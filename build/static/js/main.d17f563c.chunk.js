(this.webpackJsonpruokalista=this.webpackJsonpruokalista||[]).push([[0],{53:function(e,t,o){},54:function(e,t,o){"use strict";o.r(t);var a=o(6),n=o.n(a),s=o(39),c=o(29),r=o(4),d=o(5),i=o(8),l=o(7),u=o(30),j=o(11),b={food1:{name:"Makaroonilaatikko"},food2:{name:"Lasagne"},food3:{name:"Kasvissosekeitto"},food4:{name:"Makkarakeitto"}},f=o(40),m=(Object(f.a)({apiKey:"AIzaSyCpJdjsSONNDflytbVETLkQm2Z0NrU323g",authDomain:"ruokalista-f3217.firebaseapp.com",databaseURL:"https://ruokalista-f3217-default-rtdb.europe-west1.firebasedatabase.app",projectId:"ruokalista-f3217",storageBucket:"ruokalista-f3217.appspot.com",messagingSenderId:"100614683269",appId:"1:100614683269:web:a09412cfbc8402686047ec"}),o(14)),h=o(9),O=function(e){return Object(h.jsxs)("li",{className:"menu-food",children:[Object(h.jsx)("p",{className:"food-name",children:e.details.name}),Object(h.jsx)("button",{className:"delete-food",onClick:function(){return e.deleteFood(e.i)},children:"Poista ruoka"})]})},p=function(e){Object(i.a)(o,e);var t=Object(l.a)(o);function o(){var e;Object(r.a)(this,o);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).renderRandomFoods=function(t){return e.props.foods[t]?Object(h.jsx)(O,{i:t,details:e.props.foods[t],deleteFood:e.props.deleteFood},t):null},e}return Object(d.a)(o,[{key:"render",value:function(){var e=Object.keys(this.props.randomFoods);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("ul",{children:e.map(this.renderRandomFoods)}),Object(h.jsx)("button",{className:"get-random",onClick:this.props.getRandomFood,children:"Arvo ruoka"})]})}}]),o}(n.a.Component),v=function(e){Object(i.a)(o,e);var t=Object(l.a)(o);function o(){var e;Object(r.a)(this,o);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).nameRef=n.a.createRef(),e.addFood=function(t){t.preventDefault();var o={name:e.nameRef.current.value};e.props.addFood(o),t.currentTarget.reset()},e}return Object(d.a)(o,[{key:"render",value:function(){return Object(h.jsxs)("form",{className:"add-food",onSubmit:this.addFood,children:[Object(h.jsx)("input",{type:"text",name:"name",ref:this.nameRef}),Object(h.jsx)("button",{type:"submit",children:"Lis\xe4\xe4 ruoka"})]})}}]),o}(n.a.Component),k=o(0),x=o.n(k),F=o(3),g=o(21),y=function(e){Object(i.a)(o,e);var t=Object(l.a)(o);function o(){var e;Object(r.a)(this,o);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).state={uid:null,owner:null},e.authHandler=function(t){var o=Object(m.e)(Object(m.b)());Object(m.a)(o).then((function(o){if(console.log(o.val()),console.log(o.val().owner),!o.val().owner){console.log("No data available");var a=Object(m.b)();Object(m.f)(Object(m.e)(a),{owner:t.user.uid})}e.setState({uid:t.user.uid,owner:o.val().data||t.user.uid})})).catch((function(e){console.error(e)}))},e.logout=Object(F.a)(x.a.mark((function t(){var o;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Logging out!"),o=Object(g.b)(),Object(g.e)(o).then((function(){e.setState({uid:null})})).catch((function(e){}));case 3:case"end":return t.stop()}}),t)}))),e}return Object(d.a)(o,[{key:"componentDidMount",value:function(){var e=this,t=Object(g.b)();Object(g.c)(t,(function(t){t&&e.authHandler({user:t})}))}},{key:"authenticate",value:function(){var e=new g.a,t=Object(g.b)();Object(g.d)(t,e).then((function(e){g.a.credentialFromResult(e).accessToken,e.user})).catch((function(e){e.code,e.message,e.email,g.a.credentialFromError(e);console.log(e.message)}))}},{key:"render",value:function(){var e=this,t=Object(h.jsx)("button",{onClick:this.logout,children:"Log Out!"});return this.state.uid?this.state.uid!==this.state.owner?Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:"Ainoastaan omistajalla on oikeus muokata listaa"}),t]}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("ul",{className:"foods",children:Object.keys(this.props.foods).map((function(t){return Object(h.jsx)(O,{i:t,details:e.props.foods[t],deleteFood:e.props.deleteFood},t)}))}),Object(h.jsx)(v,{addFood:this.props.addFood}),Object(h.jsx)("button",{onClick:this.props.loadSample,children:"Lataa n\xe4yte"}),t]}):Object(h.jsx)("button",{className:"google",onClick:this.authenticate,children:"Kirjaudu Googlella"})}}]),o}(n.a.Component),S=function(e){Object(i.a)(o,e);var t=Object(l.a)(o);function o(e){var a;Object(r.a)(this,o),(a=t.call(this,e)).loadSample=function(){a.setState({foods:b})},a.addFood=function(e){var t=Object(c.a)({},a.state.foods);t["food".concat(Date.now())]=e,a.setState({foods:t})},a.deleteFood=function(e){var t=Object(c.a)({},a.state.foods);delete t[e],Object.keys(a.state.randomFoods).indexOf(e)>-1&&a.removeRandomFood(e),a.setState({foods:t})},a.getRandomFood=function(e){if(Object.keys(a.state.randomFoods).length<Object.keys(a.state.foods).length){for(var t=a.randomProperty(a.state.foods);Object.keys(a.state.randomFoods).indexOf(t)>-1;)t=a.randomProperty(a.state.foods);var o=Object(c.a)({},a.state.randomFoods);o[t]=t,a.setState({randomFoods:o})}},a.removeRandomFood=function(e){var t=Object(c.a)({},a.state.randomFoods);delete t[e],a.setState({randomFoods:t})};var n="Ruokalista",s=localStorage.getItem(n);return s||(s="{}"),a.state={foods:{},randomFoods:JSON.parse(s),appName:n},a}return Object(d.a)(o,[{key:"randomProperty",value:function(e){var t=Object.keys(e);return t[t.length*Math.random()<<0]}},{key:"componentDidMount",value:function(){var e=this,t=Object(m.b)(),o=Object(m.e)(t,"".concat(this.state.appName,"/foods"));Object(m.d)(o,(function(t){var o=t.val();null!==o&&o.foods!==e.state.foods&&e.setState({foods:o})}))}},{key:"componentDidUpdate",value:function(){var e=Object(m.b)();Object(m.f)(Object(m.e)(e,this.state.appName),{foods:this.state.foods}),localStorage.setItem(this.state.appName,JSON.stringify(this.state.randomFoods))}},{key:"componentWillUnmount",value:function(){var e=Object(m.b)(),t=Object(m.e)(e,this.state.appName);Object(m.c)(t)}},{key:"render",value:function(){return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(u.a,{children:[Object(h.jsxs)(j.c,{children:[Object(h.jsxs)(j.a,{exact:!0,path:"/",children:[Object(h.jsx)("h1",{children:"Ruokalista"}),Object(h.jsx)(p,{randomFoods:this.state.randomFoods,getRandomFood:this.getRandomFood,deleteFood:this.removeRandomFood,foods:this.state.foods})]}),Object(h.jsx)(j.a,{exact:!0,path:"/edit",children:Object(h.jsx)(y,{foods:this.state.foods,addFood:this.addFood,loadSample:this.loadSample,appName:this.state.appName})})]}),Object(h.jsx)("nav",{className:"main-nav",children:Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)(u.b,{to:"/",children:"Ruokalista"})}),Object(h.jsx)("li",{children:Object(h.jsx)(u.b,{to:"edit/",children:"Muokkaa"})})]})})]})})}}]),o}(n.a.Component);o(53);Object(s.render)(Object(h.jsx)(n.a.StrictMode,{children:Object(h.jsx)(S,{})}),document.querySelector("#root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.d17f563c.chunk.js.map